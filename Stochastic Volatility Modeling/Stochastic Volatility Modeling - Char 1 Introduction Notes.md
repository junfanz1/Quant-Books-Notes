Stochastic Volatility Modeling - Char 1 Introduction Notes
====

Junfan Zhu

2021 - 06 - 09

![Book](https://user-images.githubusercontent.com/56275127/121436137-a4d0b600-c945-11eb-862c-f00afe6e1efd.png)

This is a short notes based on Chapter 1 of the book. 

__Stochastic Volatility Modeling (Chapman and Hall/CRC Financial Mathematics Series) 1st Edition, by Lorenzo Bergomi__

> [Book Link](https://www.amazon.com/Stochastic-Volatility-Modeling-Financial-Mathematics/dp/1482244063)

---

Table of Contents
--- 

<!-- TOC -->

- [Stochastic Volatility Modeling - Char 1 Introduction Notes](#stochastic-volatility-modeling---char-1-introduction-notes)
  - [Table of Contents](#table-of-contents)
- [Chapter 1. Introduction](#chapter-1-introduction)
- [1. Black-Scholes](#1-black-scholes)
  - [1.1. Multiple hedging instruments](#11-multiple-hedging-instruments)
- [2. Delta Hedging](#2-delta-hedging)
  - [2.1. Comparing the real case with the Black-Scholes case](#21-comparing-the-real-case-with-the-black-scholes-case)
- [3. Stochastic Volatility](#3-stochastic-volatility)
  - [3.1. Vanna Volga Method](#31-vanna-volga-method)
  - [3.2. Example 1: Barrier Option](#32-example-1-barrier-option)
  - [3.3. Example 2: Forward-start option (Cliquets)](#33-example-2-forward-start-option-cliquets)
- [4. Conclusion](#4-conclusion)

<!-- /TOC -->

Chapter 1. Introduction
===

Models not conforming to such type of specification – or to some canonical set of *stylized* facts – are deemed
“wrong”. This would be suitable if 
- the realized dynamics of securities benevolently complied with the model’s specification.
- practitioners only engaged in delta-hedging. 

The issue, from a practitioner’s perspective, is not to be able to __predict__ anything, but rather to be able to __differentiate__ risks generated by these different contributions to  P&L and to ensure that the model offers the capability of pricing these different types of risk consistently across the book at levels that can be __individually controlled__. It is then a trading decision to either hedge away some of these risks, by taking offsetting positions in more liquid – say vanilla – options or by taking offsetting positions in other exotic derivatives, or to keep these risks on the book.

# 1. Black-Scholes

$$\frac{d P_{\widehat{\sigma}}}{d t}-r P_{\widehat{\sigma}}+(r-q) S \frac{d P_{\widehat{\sigma}}}{d S}=-\frac{\widehat{\sigma}^{2}}{2} S^{2} \frac{d^{2} P_{\widehat{\sigma}}}{d S^{2}}\tag{1.4}$$

## 1.1. Multiple hedging instruments

$$
P \& L=-\frac{S^{2}}{2} \frac{d^{2} P_{\widehat{\sigma}}}{d S^{2}}\left(\frac{\delta S^{2}}{S^{2}}-\widehat{\sigma}^{2} \delta t\right) \tag{1.5}
$$

is a useful accounting tool,

where $\phi_{i j}(t, S)=\left.S_{i} S_{j} \frac{d^{2} P}{d S_{i} d S_{j}}\right|_{t,S}$, $S$ denotes the vector of the $S_{i}$.

For multiple hedge instruments *market model*, there exists a positive break-even covariance matrix $C(t, S), \forall S, \forall t$, such that the model's theta and cross-gammas are related through:
$$
A=-\frac{1}{2} \Sigma_{i j} \phi_{i j} C_{i j}
$$

# 2. Delta Hedging

Standard deviation of P&L:

$$\frac{\operatorname{StDev}(P \& L)}{\left|\widehat{\sigma} \frac{d P_{\hat{\sigma}}}{d \widehat{\sigma}}\right|} \simeq \sqrt{\frac{2+\kappa}{4 N}+\frac{\rho \Omega}{2} \frac{k T-1+e^{-k T}}{(k T)^{2}}} \tag{1.16}$$

## 2.1. Comparing the real case with the Black-Scholes case

![Figure 1.2](https://user-images.githubusercontent.com/56275127/121419676-d3dd2c80-c931-11eb-850d-ab6e96dfc590.png)

Right-hand side in equation 1.16 (darker line), as a function of maturity, compared to the same quantity, but without the kurtosis term (dashed line), and the lognormal case (lighter line).

We can see that the standard deviation of the final P&L of a delta-hedged option in the real case is much larger than its estimation in the Black-Scholes case.

The conclusion is that, in real life, delta-hedging is not sufficient: while deltahedging removes the linear term in $\delta S$ in our daily P\&L, the effect of the $\delta S^{2}$ term is still too large: the only way to remove it is to use other options - for example vanilla options - to offset the gamma of the option we are risk-managing. __"Options are hedged with options".__

# 3. Stochastic Volatility

Let's use other options to offset the gamma of the exotic option we are risk-managing: assume for simplicity that we use a single vanilla option, whose implied volatility is $\widehat{\sigma}_{O}$. The P\&L of a delta-hedged position in the vanilla option $O$ has the same form as in equation (1.5), except it involves the implied volatility $\widehat{\sigma}_{O}$ :
$$
P \& L_{O}=-\frac{S^{2}}{2} \frac{d^{2} O}{d S^{2}}\left(\frac{\delta S^{2}}{S^{2}}-\widehat{\sigma}_{O}^{2} \delta t\right) \tag{1.17}
$$
The number $\lambda$ of vanilla options $O$ we are buying as gamma hedge is :
$$
\lambda=\frac{1}{\frac{d^{2} O}{d S^{2}}} \frac{d^{2} P}{d S^{2}} \tag{1.18}
$$
The gamma profiles of $P$ and $O$ are unlikely to be homothetic, thus this gamma hedge will be efficient only locally; as time elapses and $S$ moves, we need to readjust the hedge ratio $\lambda$.

We could decide to risk-manage each option $P$ and $O$ with its own implied volatility $\widehat{\sigma}$ and $\widehat{\sigma}_{O}$, but this leads to incongruous carry P\&Ls.

Our pricing function depends on 2 dynamic variables: $S, \widehat{\sigma}_{O}$

$$P\left(t, S, \widehat{\sigma}_{O}\right)$$

and we can use 2 instruments as hedges, as calibration and trading decision, we *decide* to make exotic option's price a function of other derivatives' prices.

$$\begin{aligned} \rm P \& L &=-\left(\frac{d P}{d \widehat{\sigma}_{O}}-\lambda \frac{d O}{d \widehat{\sigma}_{O}}\right) \delta \widehat{\sigma}_{O} \\ &-\frac{1}{2}\left(\frac{d^{2} P}{d \widehat{\sigma}_{O}^{2}}-\lambda \frac{d^{2} O}{d \widehat{\sigma}_{O}^{2}}\right) \delta \widehat{\sigma}_{O}^{2}-\left(\frac{d^{2} P}{d S d \widehat{\sigma}_{O}}-\lambda \frac{d^{2} O}{d S d \widehat{\sigma}_{O}}\right) \delta S \delta \widehat{\sigma}_{O} \end{aligned} \tag{1.20}$$

- Mark-to market P\&L: P\&L generated by the variation of parameters that were supposed to stay constant in the pricing model: typically, in the Black-Scholes model a change in $\widehat{\sigma}$ generates mark-to-market P\&L.

---

Aim of stochastic volatility is not to model the dynamics of *realized volatility*, which is hedged away by trading other options, but to model the dynamics of *implied* volatilities, and provide simple break-even accounting conditions for the P&L of a hedged position.

Unlike in the unhedged case for the $\delta S^{2}$ term, no deterministic $\delta t$ term is now offsetting the $\delta \widehat{\sigma}_{O}^{2}$ and $\delta S \delta \widehat{\sigma}_{O}$ terms: depending on their realized values and the signs of their prefactors, we may systematically make or lose money. This is a serious issue. While in the Black-Scholes pricing equation we had a parameter - the implied volatility - to control how the gamma and theta terms for the spot offset each other, we have no equivalent parameter at our disposal to control break-even levels for gammas on $\widehat{\sigma}_{O}$ : no implied volatility of $\widehat{\sigma}_{O}$ and no implied correlation of $S$ and $\widehat{\sigma}_{O} . P$ and $O$ should then be given by a different pricing equation than Black-Scholes', that explicitly includes these new parameters so as to generate additional theta terms in the P&L: this is the general task of stochastic volatility models.

---
## 3.1. Vanna Volga Method

The vanna-volga method $-$ see $[29]$ - once used on FX desks for generating FX smiles is a poor man's answer to this issue, with "exotic" option $P$ a European option.

Rather than using a single vanilla option $O$ we use 3 of them, and find quantities $\lambda_{i}$ so that the 3 sensitivities $\frac{d}{d \sigma}, \frac{d^{2}}{d S d \sigma}, \frac{d^{2}}{d \sigma^{2}}$ of the hedged position $P-\Sigma_{\iota=1}^{3} \lambda_{i} O_{i}$ vanish (a) in the Black-Scholes model for an implied volatility $\widehat{\sigma}_{0}$, (b) for current values of $t, S$. Cancellation of $\frac{d}{d \sigma}$ is equivalent to cancellation of $\frac{d^{2}}{d S^{2}}$, owing to the vega/gamma relationship in the Black-Scholes model - see Section A.1 of Chapter 5.

The hedging options are bought/sold at market prices, at implied volatilities $\widehat{\sigma}_{i}$, thus the difference $O_{i}^{\mathrm{BS}}\left(\widehat{\sigma}_{i}\right)-O_{i}^{\mathrm{BS}}\left(\widehat{\sigma}_{0}\right)$ has to be passed on to the client as a hedging cost. We thus define the "market-adjusted" price $P^{\text {Mkt }}$ of option $P$ as:
$$
P^{\mathrm{Mkt}}=P^{\mathrm{BS}}\left(\widehat{\sigma}_{0}\right)+\Sigma_{i} \lambda_{i}\left(O_{i}^{\mathrm{BS}}\left(\widehat{\sigma}_{i}\right)-O_{i}^{\mathrm{BS}}\left(\widehat{\sigma}_{0}\right)\right) \tag{1.21}
$$
The hedge portfolio is only effective for current values of $t, S$. It needs to be readjusted whenever either moves - the corresponding rehedging costs are not factored in $P^{M k t}$.

As observed in [29], the vanna-volga price in (1.21) can be written as:
$$
\begin{aligned}
P^{\mathrm{Mkt}} &=P^{\mathrm{BS}}\left(\widehat{\sigma}_{0}\right)+\left.y_{\sigma} \frac{d P^{\mathrm{BS}}}{d \widehat{\sigma}_{0}}\right|_{S, \widehat{\sigma}_{0}}+\left.y_{\sigma^{2}} \frac{d^{2} P^{\mathrm{BS}}}{d \widehat{\sigma}_{0}^{2}}\right|_{S, \widehat{\sigma}_{0}}+\left.y_{S \sigma} \frac{d^{2} P^{\mathrm{BS}}}{d S d \widehat{\sigma}_{0}}\right|_{S, \widehat{\sigma}_{0}} \\
&=P^{\mathrm{BS}}\left(\widehat{\sigma}_{0}\right)+\left.y_{S^{2}} \frac{d^{2} P^{\mathrm{BS}}}{d S^{2}}\right|_{S, \widehat{\sigma}_{0}}+\left.y_{\sigma^{2}} \frac{d^{2} P^{\mathrm{BS}}}{d \widehat{\sigma}_{0}^{2}}\right|_{S, \widehat{\sigma}_{0}}+\left.y_{S \sigma} \frac{d^{2} P^{\mathrm{BS}}}{d S d \widehat{\sigma}_{0}}\right|_{S, \widehat{\sigma}_{0}}
\end{aligned} \tag{1.22}
$$
where the second line again follows from the vega/gamma relationship in the Black-Scholes model: $y_{S^{2}}=y_{\sigma} S^{2} \widehat{\sigma}_{0} T .$ The interpretation of (1.22) is: we supplement the Black-Scholes price at implied volatility $\widehat{\sigma}_{0}$ with an estimation of future gamma P\&Ls calculated (a) with current values of the gammas and cross-gammas, (b) values for $y_{S^{2}}, y_{S \sigma}, y_{\sigma^{2}}$ such that market prices for the three vanilla options $O_{i}$ are recovered; $y_{S^{2}}, y_{S \sigma}, y_{\sigma^{2}}$ only depend on the $\widehat{\sigma}_{i}$, not on $P$. This underscores how local the vanna-volga adjustment is - it cannot replace a genuine model for pricing volatility-of-volatility risk.

Historically, the vanna-volga method has been used for interpolating implied volatilities: pick a vanilla option of strike $K$ and use (1.21) to generate the corresponding adjusted "market price"- hence implied volatility. There is obviously no guarantee that the resulting interpolation $\widehat{\sigma}^{\mathrm{Mkt}}\left(K, \widehat{\sigma}_{0}, \widehat{\sigma}_{i}\right)$ is arbitrage-free.

---

## 3.2. Example 1: Barrier Option

As we unwind our static hedge, the magnitude of the then-prevailing at- the-money skew will determine whether we make or lose money. The Black-Scholes price of the barrier option has then to be adjusted manually to include an estimation of this gain or loss. The price of a barrier option is mostly dependent on the dynamics of the at-the-money skew conditional on $S$ hitting the barrier. 

Besides the forward-skew risk, the price of the barrier option needs to be adjusted for gap risk. Unwinding the European hedge – or unwinding the delta – cannot be done instantaneously as $S$ crosses $L$. In our case, the delta of the barrier option we have sold is negative: we will need to buy stocks (or sell the double digital option) at a spot level that is presumably larger than $L$, thus incurring a loss. We must thus adjust the price charged for the barrier option to cover, on average, this loss.

A stochastic volatility model for barrier options would need to provide a direct handle on this precise feature of the dynamics of the volatility surface so as to appropriately reflect its P&L impact in the option price.

## 3.3. Example 2: Forward-start option (Cliquets)

Forward-start options - also called cliquets - involve the ratio of a security's price observed at two different dates. Let $T_{1}$ and $T_{2}$ be two dates in the future and consider the case of a simple call cliquet whose payoff at $T_{2}$ is given by
$$
\left(\frac{S_{T_{2}}}{S_{T_{1}}}-k\right)^{+}
$$
Let us choose $k=100 \%$ - this is called a forward-start at-the-money call. The price $P$ of this option in the Black-Scholes model, because of homogeneity, does not depend on $S$ and only depends on volatility. Assuming zero interest rates for simplicity, for $k=100 \%$, the Black-Scholes price of our cliquet is approximately given by:
$$
P \simeq \frac{1}{\sqrt{2 \pi}} \sigma \sqrt{T_{2}-T_{1}}
$$
The fact that $P$ does not depend on $S$ is worrisome: the only instrument whose dynamics is accounted for in the Black-Scholes model is $S$, yet $S$ is not appearing in the pricing function. $P$ is only a function of volatility $\sigma-\sigma$ is in fact the real underlying of the cliquet option.

A cliquet is an option on volatility, more precisely on forward implied volatility, that is the future implied volatility observed at $T_{1}$ for maturity $T_{2}$. At $t=T_{1}$, the cliquet becomes a vanilla option of maturity $T_{2}$, in our case a call option struck at $k S_{T_{1}}$. A suitable hedging strategy needs to generate at time $T_{1}$ the money needed to purchase a call option of maturity $T_{2}$ struck at $k S_{T_{1}}$

# 4. Conclusion

- Vanilla options should be considered as hedging instruments in their own right and their dynamics modeled accordingly; as such the task of a stochastic volatility model is to model the joint dynamics of the underlying security and its associated volatility surface.

- Delta hedging is not adequate for reducing the standard deviation of the P\&L of an option position to reasonable levels. The sources of the dispersion of this P\&L are: (a) the tails of returns, (b) the volatility of realized volatility and the correlation of future realized volatilities - see (1.15). Except for very short options, the latter effect prevails, because of the long-ranged nature of volatility/volatility correlations.
- Using options for gamma-hedging immunizes us against realized volatility. Dynamical trading of vanilla options, however, exposes us to uncertainty as to future levels of implied volatilities. Stochastic volatility models are thus needed for modeling the dynamics of implied volatilities, rather than that of realized volatility.
- Exotic options often depend in a complex way on the dynamics of implied volatilities. Some specific classes of options, such as barrier options, or cliquets, are such that their volatility risk can be pinpointed, enabling an easier assessment of the suitability of a given model.